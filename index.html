<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>≈ûafak Vakti</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <style>
        :root { --accent: #38bdf8; --bg: #0f172a; --text: #1e293b; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; margin: 0; padding-bottom: 90px; }
        
        #duyuru-bar { padding: 12px; font-weight: bold; text-align: center; display: none; }
        
        .header { padding: 40px 20px; text-align: center; }
        .timer { font-size: 4rem; font-weight: 800; color: var(--accent); margin: 10px 0; }
        
        .main-container { background: #f1f5f9; color: var(--text); border-top-left-radius: 35px; border-top-right-radius: 35px; padding: 25px 15px; min-height: 800px; }
        
        .vakit-grid { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 15px; scrollbar-width: none; }
        .vakit-item { min-width: 75px; background: white; padding: 12px 5px; border-radius: 15px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .vakit-item.active { border: 2px solid var(--accent); background: #e0f2fe; }
        
        .pro-card { border-radius: 20px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); position: relative; }
        .card-tag { font-size: 0.75rem; font-weight: 800; text-transform: uppercase; margin-bottom: 10px; display: flex; align-items: center; gap: 6px; color: var(--accent); }
        .card-text { font-size: 1rem; line-height: 1.6; font-weight: 500; }
        
        .share-btn { margin-top: 15px; background: #e2e8f0; border: none; padding: 8px 15px; border-radius: 10px; font-size: 0.8rem; font-weight: bold; cursor: pointer; color: #475569; }
        
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; display: flex; justify-content: space-around; padding: 18px; border-top: 1px solid #e2e8f0; }
        .nav-item { color: #94a3b8; font-size: 1.3rem; cursor: pointer; }
        .nav-item.active { color: var(--accent); }
    </style>
</head>
<body>

<div id="duyuru-bar"></div>

<div id="page-home">
    <div class="header">
        <h2 style="margin:0">Ceylanpƒ±nar</h2>
        <div class="timer" id="countdown">00:00:00</div>
        <div id="h-date" style="opacity:0.8">Y√ºkleniyor...</div>
    </div>

    <div class="main-container">
        <div class="vakit-grid" id="vakit-list"></div>

        <div id="content-area">
            <div class="pro-card" id="card-ayet-bg">
                <div class="card-tag"><i class="fas fa-book-open"></i> Vaktin Ayeti</div>
                <div class="card-text" id="txt-ayet">...</div>
                <button class="share-btn" onclick="paylas('Vaktin Ayeti', 'txt-ayet')"><i class="fas fa-share-alt"></i> Payla≈ü</button>
            </div>

            <div class="pro-card" id="card-hadis-bg">
                <div class="card-tag"><i class="fas fa-quote-left"></i> Vaktin Hadisi</div>
                <div class="card-text" id="txt-hadis">...</div>
                <button class="share-btn" onclick="paylas('Vaktin Hadisi', 'txt-hadis')"><i class="fas fa-share-alt"></i> Payla≈ü</button>
            </div>

            <div class="pro-card" id="card-esma-bg" style="background: linear-gradient(135deg, #0ea5e9, #2563eb); color: white;">
                <div class="card-tag" style="color:white"><i class="fas fa-star"></i> Esma√ºl H√ºsna</div>
                <div class="card-text" id="txt-esma" style="font-size: 1.2rem; text-align:center; font-weight: 800;">...</div>
            </div>

            <div class="pro-card" id="card-dua-bg">
                <div class="card-tag"><i class="fas fa-hands-praying"></i> G√ºnl√ºk Dua</div>
                <div class="card-text" id="txt-dua">...</div>
                <button class="share-btn" onclick="paylas('G√ºnl√ºk Dua', 'txt-dua')"><i class="fas fa-share-alt"></i> Payla≈ü</button>
            </div>

            <div class="pro-card" id="card-bilgi-bg">
                <div class="card-tag"><i class="fas fa-info-circle"></i> G√ºn√ºn Bilgisi</div>
                <div class="card-text" id="txt-bilgi">...</div>
                <button class="share-btn" onclick="paylas('G√ºn√ºn Bilgisi', 'txt-bilgi')"><i class="fas fa-share-alt"></i> Payla≈ü</button>
            </div>
        </div>
    </div>
</div>

<nav class="bottom-nav">
    <div class="nav-item active"><i class="fas fa-home"></i></div>
    <div class="nav-item"><i class="fas fa-compass"></i></div>
    <div class="nav-item"><i class="fas fa-book"></i></div>
    <div class="nav-item"><i class="fas fa-cog"></i></div>
</nav>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyC6VtB6eHqiNNyoJ0x4yCpnGChB6p9AYnM",
        authDomain: "safakvakti-5f929.firebaseapp.com",
        projectId: "safakvakti-5f929",
        storageBucket: "safakvakti-5f929.firebasestorage.app",
        messagingSenderId: "1089272374742",
        appId: "1:1089272374742:web:bc422dad721627342fb077"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const vNames = { Fajr:"ƒ∞msak", Sunrise:"G√ºne≈ü", Dhuhr:"√ñƒüle", Asr:"ƒ∞kindi", Maghrib:"Ak≈üam", Isha:"Yatsƒ±" };
    let vTimes = {};

    async function init() {
        const res = await fetch('https://api.aladhan.com/v1/timingsByCity?city=Ceylanpinar&country=Turkey&method=13');
        const d = await res.json();
        vTimes = d.data.timings;
        document.getElementById('h-date').innerText = d.data.date.hijri.day + " " + d.data.date.hijri.month.en + " " + d.data.date.hijri.year;
        
        const list = document.getElementById('vakit-list');
        Object.keys(vNames).forEach(k => {
            list.innerHTML += `<div class="vakit-item" id="v-${k}"><div style="font-size:0.7rem; font-weight:bold; color:#64748b">${vNames[k]}</div><div style="font-size:1rem; font-weight:800; margin-top:5px">${vTimes[k]}</div></div>`;
        });
        setInterval(counter, 1000);
        sync();
    }

    function counter() {
        const now = new Date();
        let next = null; let nextK = "";
        Object.keys(vNames).forEach(k => {
            const [h, m] = vTimes[k].split(':');
            let v = new Date(); v.setHours(h, m, 0);
            if (v < now) v.setDate(v.getDate() + 1);
            if (!next || (v - now) < (next - now)) { next = v; nextK = k; }
            document.getElementById(`v-${k}`).classList.remove('active');
        });
        const diff = next - now;
        const h = Math.floor(diff/3600000); const m = Math.floor((diff%3600000)/60000); const s = Math.floor((diff%60000)/1000);
        document.getElementById('countdown').innerText = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
        document.getElementById(`v-${nextK}`).classList.add('active');
    }

    function sync() {
        db.collection("icerik").doc("guncel").onSnapshot(doc => {
            if(doc.exists) {
                const v = doc.data();
                const map = { ayet:'txt-ayet', hadis:'txt-hadis', esma:'txt-esma', dua:'txt-dua', bilgi:'txt-bilgi' };
                Object.keys(map).forEach(k => {
                    document.getElementById(map[k]).innerText = v[k] || "...";
                    if(v[k+'R']) document.getElementById('card-'+k+'-bg').style.backgroundColor = v[k+'R'];
                });
                const dBar = document.getElementById('duyuru-bar');
                if(v.duyuru) { dBar.innerText = "üì¢ " + v.duyuru; dBar.style.background = v.duyuruR; dBar.style.display = "block"; }
                else dBar.style.display = "none";
            }
        });
    }

    function paylas(title, id) {
        const text = document.getElementById(id).innerText;
        if (navigator.share) {
            navigator.share({ title: '≈ûafak Vakti', text: title + ":\n" + text + "\n\n≈ûafak Vakti Uygulamasƒ±" });
        }
    }
    init();
</script>
</body>
</html>
